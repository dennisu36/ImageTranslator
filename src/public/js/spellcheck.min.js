/** Javascript/PHP Spell Checker v1.6.1 https://github.com/LPology/Javascript-PHP-Spell-Checker Copyright 2012-2015 LPology, LLC Released under the MIT license */
!function(t,e,s){var n=t.sc||{},i=/^\s+/,o=/\s+$/,r=/[^\s]+/,c=/[^\s]+$/,l=/[xy]/g,u=/&/g,h=/"/g,d=/'/g,a=/</g,_=/>/g,p=/^\w+$/,g={},f=function(t){return e.getElementById(t)};n.objectKeys=function(t){"use strict";var e=[];for(var s in t)t.hasOwnProperty(s)&&e.push(s);return e},n.obj2string=function(t,e){"use strict";var s=[];for(var i in t)if(t.hasOwnProperty(i)){var o=e?e+"["+i+"]":i,r=t[i];s.push("object"==typeof r?n.obj2string(r,o):encodeURIComponent(o)+"="+encodeURIComponent(r))}return s.join("&")},n.extendObj=function(t,e){"use strict";for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},n.isEmpty=function(t){"use strict";for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},n.contains=function(t,e){"use strict";for(var s=t.length;s--;)if(t[s]===e)return!0;return!1},n.purge=function(t){"use strict";var e,s,i,o=t.attributes;if(o)for(e=o.length-1;e>=0;e-=1)i=o[e].name,"function"==typeof t[i]&&(t[i]=null);if(o=t.childNodes)for(s=o.length,e=0;s>e;e+=1)n.purge(t.childNodes[e])},n.remove=function(t){"use strict";t&&t.parentNode&&(n.purge(t),t.parentNode.removeChild(t)),t=null};var v="".trim;n.trim=v&&!v.call("\ufeffÂ ")?function(t){return null===t?"":v.call(t)}:function(t){return null===t?"":t.toString().replace(i,"").replace(o,"")},n.getId=function(){"use strict";return"axxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(l,function(t){var e=16*Math.random()|0,s="x"==t?e:3&e|8;return s.toString(16)})},n.addEvent=function(t,s,i){"use strict";return"string"==typeof t&&(t=e.getElementById(t)),t.addEventListener?t.addEventListener(s,i,!1):t.attachEvent("on"+s,i),function(){n.removeEvent(t,s,i)}},n.removeEvent=function(t,s,n){"use strict";"string"==typeof t&&(t=e.getElementById(t)),t.removeEventListener?t.removeEventListener(s,n,!1):t.detachEvent("on"+s,n)},n.newXHR=function(){"use strict";if("undefined"!=typeof XMLHttpRequest)return new t.XMLHttpRequest;if(t.ActiveXObject)try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){return!1}},n.encodeHTML=function(t){"use strict";return String(t).replace(u,"&amp;").replace(h,"&quot;").replace(d,"&#39;").replace(a,"&lt;").replace(_,"&gt;")},n.parseJSON=function(e){"use strict";if(!e)return!1;if(e=n.trim(e+""),t.JSON&&t.JSON.parse)try{return t.JSON.parse(e+"")}catch(s){return!1}var i,o=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g,r=null;return e&&!n.trim(e.replace(o,function(t,e,s,n){return i&&e&&(r=0),0===r?t:(i=s||e,r+=!n-!s,"")}))?Function("return "+e)():!1},n.verifyElem=function(s){"use strict";return"undefined"!=typeof jQuery&&s instanceof jQuery?s=s[0]:"string"==typeof s&&("#"==s.charAt(0)&&(s=s.substr(1)),s=e.getElementById(s)),s&&1===s.nodeType?("A"==s.nodeName.toUpperCase()&&(s.style.cursor="pointer",n.addEvent(s,"click",function(e){e&&e.preventDefault?e.preventDefault():t.event&&(t.event.returnValue=!1)})),s):!1},n.SpellChecker=function(t){var e=this;if(this._settings={action:"",button:"",textInput:"",name:"text",data:{},debug:!1,onOpen:function(){},onClose:function(){}},n.extendObj(this._settings,t),this._button=n.verifyElem(this._settings.button),this._textInput=n.verifyElem(this._settings.textInput),delete this._settings.button,this._button===!1)throw new Error("Invalid button. Make sure the element you're passing exists.");if(this._textInput===!1)throw new Error("Invalid text field. Make sure the element you're passing exists.");this._closeOnEsc=function(t){27===t.keyCode&&e._closeChecker()},this._uId=n.getId(),this._createHTML(),this._currentBox=f("spell-current"+this._uId),this._contextBox=f("spell-context"+this._uId),this._undoBtn=f("spell-undo"+this._uId),this._select=f("spelling-suggestions"+this._uId),this._isOpen=!1,this._button.className+=" spellcheck-trigger",this.enable()},n.SpellChecker.prototype={enable:function(){"use strict";var t=this;this._button.off=n.addEvent(this._button,"click",function(){t._openChecker()}),n.addEvent("spelling-ignore"+this._uId,"click",function(){t._ignore()}),n.addEvent("spelling-ignore-all"+this._uId,"click",function(){t._ignore(!0)}),n.addEvent("spell-change"+this._uId,"click",function(){t._makeChange()}),n.addEvent("spell-change-all"+this._uId,"click",function(){t._makeChange(!0)}),n.addEvent("spell-close"+this._uId,"click",function(){t._closeChecker()}),n.addEvent("spell-msg-close"+this._uId,"click",function(){t._closeChecker()}),n.addEvent("spell-check-overlay"+this._uId,"click",function(){t._closeChecker()}),n.addEvent(this._undoBtn,"click",function(){t._undoChange()}),n.addEvent(this._currentBox,"click",function(){f("spelling-suggestions"+t._uId).selectedIndex=-1}),n.addEvent(this._contextBox,"click",function(){f("spelling-suggestions"+t._uId).selectedIndex=-1}),n.addEvent(this._currentBox,"keyup",function(){var t=this._contextBox.getElementsByTagName("span")[0];t&&t.firstChild&&(t.firstChild.nodeValue=this.value)}),n.addEvent(this._contextBox,"keyup",function(){var t=this.getElementsByTagName("span")[0];t&&t.firstChild&&(this._currentBox.value=t.firstChild.nodeValue)})},destroy:function(){"use strict";this._isOpen&&this._closeChecker(),this._button.off&&this._button.off(),this._button.className=this._button.className.replace(/(?:^|\s)spellcheck-trigger(?!\S)/,""),n.remove(this._msgBox),n.remove(this._modal),n.remove(this._overlay);for(var t in this)this.hasOwnProperty(t)&&delete this.prop},log:function(e){"use strict";this._settings.debug&&t.console&&t.console.log("[spell checker] "+e)},_getRegex:function(t){"use strict";return g[t]||(g[t]=new RegExp(t,"g")),g[t]},_openChecker:function(){"use strict";this._isOpen||(this._undoBtn.disabled=!0,this._overlay.style.display="block",this._modal.style.display="block",this._text=this._textInput.value,this._isOpen=!0,this._undo=[],n.addEvent(e,"keyup",this._closeOnEsc),this._notifyMsg("a"),this._sendData())},_closeChecker:function(){"use strict";this._isOpen&&(this._msgBox.style.display="none",this._modal.style.cssText="display:none; z-index:4999;",this._overlay.style.display="none",this._currentBox.value="",this._contextBox.innerHTML="",this._select.options.length=0,this._undo.length=0,this._text=this._wordObject=this._wordKeys=this._currentWord=this._wordMatches=this._matchOffset=this._undo=this._isOpen=null,n.removeEvent(e,"keyup",this._closeOnEsc),this._settings.onClose.call(this,this._button,this._textInput.value))},_notifyMsg:function(t){"use strict";var e,s=f("spell-msg-close-box"+this._uId);"a"==t?(e="Checking...",s.style.display="none"):s.style.display="block","b"==t&&(e="We experienced an error and were unable to complete the spell check."),"c"==t&&(e="Spell check completed. No errors found."),"d"==t&&(e="Spell check completed."),this._modal.style.zIndex=4999,f("spell-msg-text"+this._uId).innerHTML=e,this._msgBox.style.display="block","a"!=t&&f("spell-msg-close"+this._uId).focus()},_ignore:function(t){"use strict";var e;t===!0||this._wordMatches<=1||this._matchOffset===this._wordMatches?(this._wordKeys.splice(0,1),this._matchOffset=1,e=!1):(this._matchOffset++,e=!0),this._undoBtn.disabled=!0,this._undo.length=0,this._wordKeys.length>0||e===!0?this._reviewWord():this._notifyMsg("d")},_makeChange:function(t){"use strict";var e,s,n,i=this,o=this._getRegex(this._currentWord),r=this._select.selectedIndex,c=0;this._undo.unshift({text:this._text,word:this._currentWord,numMatches:this._wordMatches,matchOffset:this._matchOffset}),this._undoBtn.disabled=!1,e=r>-1?this._select.options[r].text:this._currentBox.value,s=this._text.replace(o,function(s){return c++,t===!0||i._matchOffset===c?e:s}),t===!0||i._wordMatches<=1||i._matchOffset===i._wordMatches?(this._wordKeys.splice(0,1),this._matchOffset=1,n=!1):n=!0,this._textInput.value=this._text=s,this._wordKeys.length>0||n===!0?this._reviewWord():this._notifyMsg("d")},_undoChange:function(){"use strict";var t=this._undo[0];this._textInput.value=this._text=t.text,this._currentBox.value=t.word,n.contains(this._wordKeys,t.word)||this._wordKeys.unshift(t.word),this._currentWord=t.word,this._wordMatches=t.numMatches,this._matchOffset=t.matchOffset,this._setSuggestionOptions(),this._setContextBox(),this._undo.splice(0,1),this._undo.length<1&&(this._undoBtn.disabled=!0)},_setSuggestionOptions:function(){"use strict";var t,e=this._wordObject[this._currentWord],s=e.length;for(this._select.options.length=0,t=0;s>t;t++)this._select.options[t]=new Option(e[t],e[t]);this._select.selectedIndex=0},_setContextBox:function(){"use strict";var t=this,e=this._currentWord.length,s=this._getRegex(this._currentWord),l=this._text.length,u=0;this._text.replace(s,function(s,h){if(p.test(t._text.substr(h+e,1)))return s;if(u++,u===t._matchOffset){var d,a,_=h-20,g=h+e;d=0>_?t._text.substr(0,h):t._text.substr(_,20),a=g+50>l?t._text.substr(g):t._text.substr(g,50),d=d.replace(i,"").replace(r,"").replace(i,""),a=a.replace(o,"").replace(c,"").replace(o,""),t._contextBox.innerHTML=n.encodeHTML(d)+'<span class="word-highlight">'+n.encodeHTML(t._currentWord)+"</span>"+n.encodeHTML(a)}return s})},_reviewWord:function(){"use strict";this._currentWord=this._wordKeys[0],this._currentBox.value=this._currentWord,this._wordMatches=this._getTotalWordMatches(),this._setSuggestionOptions(),this._setContextBox()},_getTotalWordMatches:function(){"use strict";var t=this._getRegex(this._currentWord),e=this._currentWord.length,s=0,n=this._text;return this._text.replace(t,function(t,i){return p.test(n.substr(i+e,1))||s++,t}),s},_begin:function(t){"use strict";t.success&&t.success===!0&&(t.errors&&t.errors===!0?(this._wordObject=t.words,this._wordKeys=n.objectKeys(this._wordObject),this._matchOffset=1,this._msgBox.style.display="none",this._modal.style.zIndex=5001,this._reviewWord()):this._notifyMsg("c"))},_sendData:function(){"use strict";var t,e,i=this,o=n.newXHR();return this._text.length<2?void this._notifyMsg("c"):(t=encodeURIComponent(this._settings.name)+"=",t+=encodeURIComponent(this._text),n.isEmpty(this._settings.data)||(t+="&",t+=n.obj2string(this._settings.data)),e=function(){var t,r,c;try{if(e&&4===o.readyState){if(e=s,o.onreadystatechange=function(){},!i._isOpen)return;r=o.status;try{c=o.statusText}catch(l){c=""}i.log("Request completed. Status: "+r+" "+c),r>=200&&300>r?(t=n.parseJSON(o.responseText),t!==!1?(i._settings.onOpen.call(i,i._button,i._text),i._begin(t)):(i.log("Error parsing server response"),i._notifyMsg("b")),o=t=null):i._notifyMsg("b")}}catch(l){i.log("Error: "+l.message),i._notifyMsg("b")}},o.onreadystatechange=e,o.open("POST",this._settings.action,!0),o.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01"),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.log("Sending data..."),void o.send(t))},_createHTML:function(){this._overlay=e.createElement("div"),this._modal=e.createElement("div"),this._msgBox=e.createElement("div"),this._overlay.className="spell-check-overlay",this._overlay.id="spell-check-overlay"+this._uId,e.body.appendChild(this._overlay),this._modal.className="spell-wrap",this._modal.innerHTML='<div class="spell-header"><div>Spell Check</div></div><div id="spelling-inner'+this._uId+'" class="spelling-inner"><div class="clearleft">Not found in dictionary:</div><div class="spell-nf"><input type="text" class="current" id="spell-current'+this._uId+'" /><div class="context" contenteditable="true" id="spell-context'+this._uId+'"></div></div><div class="spell-ignorebtns"><button id="spelling-ignore'+this._uId+'" type="button">Ignore</button><button id="spelling-ignore-all'+this._uId+'" type="button">Ignore All</button></div><div class="clearleft">Suggestions:</div><div class="spell-suggest"><select size="8" id="spelling-suggestions'+this._uId+'"><option></option></select></div><div class="spell-changebtns"><button type="button" id="spell-change'+this._uId+'">Change</button><button id="spell-change-all'+this._uId+'">Change All</button><button type="button" id="spell-undo'+this._uId+'">Undo</button></div><hr /><div class="close-box"><button type="button" id="spell-close'+this._uId+'">Close</button></div></div>',e.body.appendChild(this._modal),this._msgBox.className="spell-msg",this._msgBox.innerHTML='<div class="spell-header"><div>Spell Check</div></div><div class="spell-msg-inner"><span id="spell-msg-text'+this._uId+'"></span></div><div class="spell-msg-inner" id="spell-msg-close-box'+this._uId+'"><button id="spell-msg-close'+this._uId+'">OK</button></div>',e.body.appendChild(this._msgBox)}},t.sc=n}(window,document);
